<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>Pixel Ratio Calculatorï½œåƒç´ æ¯”ä¾‹è¨ˆç®—å™¨</title>
<meta name="description" content="Pixel Ratio Calculator â€“ è¼¸å…¥åƒç´ å¯¬é«˜ï¼Œå³æ™‚è¨ˆç®—æ¯”ä¾‹ã€å¸¸è¦‹ç•«é¢æ¯”ä¾‹ï¼ˆ16:9ã€4:3ã€21:9ï¼‰ã€‚æ”¯æ´æ·±è‰²æ¨¡å¼ã€PWAã€é›¢ç·šä½¿ç”¨ã€‚" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Open Graph -->
<meta property="og:title" content="Pixel Ratio Calculator">
<meta property="og:description" content="Instant pixel ratio calculator for designers & developers.">
<meta property="og:type" content="website">

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">
<link rel="apple-touch-icon" href="icon.png">

<style>
:root {
  --bg: #f8fafc;
  --card: #ffffff;
  --text: #0f172a;
  --muted: #64748b;
  --primary: #2563eb;
}

[data-theme="dark"] {
  --bg: #020617;
  --card: #020617;
  --text: #e5e7eb;
  --muted: #94a3b8;
  --primary: #38bdf8;
}

body {
  margin: 0;
  min-height: 100vh;
  background: var(--bg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  color: var(--text);
  display: flex;
  justify-content: center;
  align-items: center;
}

.card {
  width: 360px;
  background: var(--card);
  padding: 2rem;
  border-radius: 14px;
  box-shadow: 0 20px 40px rgba(0,0,0,.15);
}

h1 {
  font-size: 1.2rem;
  text-align: center;
  margin-bottom: 1.2rem;
}

label {
  font-size: .85rem;
  color: var(--muted);
}

input {
  width: 100%;
  padding: .6rem;
  margin: .4rem 0 1rem;
  font-size: 1rem;
  border-radius: 8px;
  border: 1px solid #cbd5f5;
}

.row {
  display: flex;
  gap: .5rem;
  margin-bottom: 1rem;
}

button {
  flex: 1;
  padding: .6rem;
  border-radius: 8px;
  border: 1px solid #cbd5f5;
  background: transparent;
  cursor: pointer;
}

.top-actions {
  display: flex;
  justify-content: space-between;
  margin-bottom: 1rem;
  font-size: .8rem;
}

.result {
  background: var(--bg);
  padding: 1rem;
  border-radius: 10px;
  text-align: center;
}

.ratio {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--primary);
}

.tag {
  margin-top: .3rem;
  display: inline-block;
  font-size: .75rem;
  padding: .25rem .6rem;
  border-radius: 999px;
  background: #e0e7ff;
  color: #1e3a8a;
}

[data-theme="dark"] .tag {
  background: #0f172a;
  color: #7dd3fc;
}

.hint {
  font-size: .75rem;
  color: var(--muted);
  margin-top: .4rem;
}
</style>
</head>

<body>
<div class="card">
  <div class="top-actions">
    <button id="lang">EN</button>
    <button id="theme">ğŸŒ™/â˜€ï¸</button>
  </div>

  <h1 id="title">Pixel æ¯”ä¾‹è¨ˆç®—å™¨</h1>

  <label id="wLabel">å¯¬åº¦ï¼ˆpxï¼‰</label>
  <input id="w" type="number">

  <label id="hLabel">é«˜åº¦ï¼ˆpxï¼‰</label>
  <input id="h" type="number">

  <div class="row">
    <button id="swap">äº¤æ›</button>
    <button id="copy">è¤‡è£½</button>
  </div>

  <div class="result" id="output">
    è«‹è¼¸å…¥å°ºå¯¸
  </div>
</div>

<script>
/* ---------- i18n ---------- */
const i18n = {
  zh: { title: 'Pixel æ¯”ä¾‹è¨ˆç®—å™¨', w: 'å¯¬åº¦ï¼ˆpxï¼‰', h: 'é«˜åº¦ï¼ˆpxï¼‰', swap: 'äº¤æ›', copy: 'è¤‡è£½', hint: 'è«‹è¼¸å…¥å°ºå¯¸' },
  en: { title: 'Pixel Ratio Calculator', w: 'Width (px)', h: 'Height (px)', swap: 'Swap', copy: 'Copy', hint: 'Enter values' }
};

let lang = localStorage.lang || 'zh';
let currentTheme = localStorage.theme || 'light';
document.documentElement.dataset.theme = currentTheme;

/* ---------- DOM ---------- */
const wInput = document.getElementById('w');
const hInput = document.getElementById('h');
const output = document.getElementById('output');
const swapBtn = document.getElementById('swap');
const copyBtn = document.getElementById('copy');
const langBtn = document.getElementById('lang');
const themeBtn = document.getElementById('theme');

/* ---------- Functions ---------- */
function setLang() {
  const t = i18n[lang];
  document.getElementById('title').textContent = t.title;
  document.getElementById('wLabel').textContent = t.w;
  document.getElementById('hLabel').textContent = t.h;
  swapBtn.textContent = t.swap;
  copyBtn.textContent = t.copy;
  if (!wInput.value || !hInput.value) output.textContent = t.hint;
}

function gcd(a,b){return b?gcd(b,a%b):a;}

const ratios = [{n:'16:9',v:16/9},{n:'4:3',v:4/3},{n:'21:9',v:21/9},{n:'1:1',v:1}];

function update() {
  const W = +wInput.value, H = +hInput.value;
  if (!W || !H) return;
  localStorage.w = W; localStorage.h = H;

  const d = gcd(W,H);
  const r = W/H;
  const close = ratios.find(x=>Math.abs(x.v-r)<0.02);

  output.innerHTML = `
    ${W} Ã— ${H}
    <div class="ratio">${W/d}:${H/d}</div>
    ${close?`<div class="tag">${close.n}</div>`:''}
    <div class="hint">${r.toFixed(3)}</div>
  `;
}

/* ---------- Event Listeners ---------- */
wInput.oninput = hInput.oninput = update;

swapBtn.onclick = () => {
  [wInput.value, hInput.value] = [hInput.value, wInput.value];
  update();
};

copyBtn.onclick = () => {
  const d = gcd(wInput.value, hInput.value);
  navigator.clipboard.writeText(`${wInput.value/d}:${hInput.value/d}`);
};

langBtn.onclick = () => {
  lang = lang==='zh'?'en':'zh';
  localStorage.lang = lang;
  setLang();
};

themeBtn.onclick = () => {
  currentTheme = currentTheme==='light'?'dark':'light';
  localStorage.theme = currentTheme;
  document.documentElement.dataset.theme = currentTheme;
};

/* ---------- Restore ---------- */
wInput.value = localStorage.w || '';
hInput.value = localStorage.h || '';
setLang();
update();

/* ---------- PWA ---------- */
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
